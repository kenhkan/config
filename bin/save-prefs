#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
HERE="$( cd "$DIR/.." && pwd)"
PREF_DIR=$HOME/Library
PREFS_PATH="$DIR/../etc/prefs.txt"
OUTPUT_NAME=prefs.tar.gz
OUT_DIR=$HERE/prefs

cd $HERE

rm -r $OUT_DIR
mkdir $OUT_DIR

while read filename
do
  dir="$(dirname "$OUT_DIR/$filename" )"
  mkdir -p "$dir"
  >&2 echo "----> Copying \"$PREF_DIR/$filename\" to \"$OUT_DIR/$filename\"..."
  cp "$PREF_DIR/$filename" "$OUT_DIR/$filename"
done < $PREFS_PATH

>&2 echo "----> Done saving preferences."
exit 0
